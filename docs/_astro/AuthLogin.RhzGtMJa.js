import{j as e}from"./index.CMSeyhcG.js";import{r as n}from"./index.1Jp-s5Xv.js";import{s as k}from"./supabaseClient.UdoNoOaI.js";import{u as o}from"./userStore.DFyG1IMG.js";import{C as L,L as S,E as A,a as P,H as _}from"./index.Cn9wiG66.js";import{O as I}from"./OAuthLogin.DbIcA2t6.js";import{M as F}from"./mail.D8UC6yT5.js";import{L as q}from"./loader-circle.B5OOkVwn.js";import"./index.CoaMyoED.js";import"./preload-helper.BlTxHScW.js";import"./index.CvL_fmfE.js";import"./createLucideIcon.BPD19Zc-.js";const G=({redirectTo:x="/",onSuccess:f,onSwitchToRegister:p,className:v=""})=>{const[t,h]=n.useState({email:"",password:""}),[c,w]=n.useState(!1),[a,b]=n.useState(!1),[m,l]=n.useState(null),[g,d]=n.useState(null),u=n.useRef(null),N="10000000-ffff-ffff-ffff-000000000001",j=i=>{const{name:s,value:r}=i.target;h(z=>({...z,[s]:r})),m&&l(null)},y=i=>{d(i)},E=()=>{d(null)},C=async i=>{if(i.preventDefault(),!t.email.trim()){l("Email is required");return}if(!t.password.trim()){l("Password is required");return}if(!g){l("Please complete the captcha verification");return}try{b(!0),l(null),o.setLoading(!0),o.setError(null);const{data:s,error:r}=await k.auth.signInWithPassword({email:t.email,password:t.password});if(r)throw r;s.user&&(o.setAuth(s.session,{id:s.user.id,email:s.user.email,username:s.user.user_metadata?.username,avatar_url:s.user.user_metadata?.avatar_url,full_name:s.user.user_metadata?.full_name}),h({email:"",password:""}),d(null),u.current?.resetCaptcha(),f?f():window.location.href=x)}catch(s){console.error("Login error:",s);let r="An error occurred during sign in";s instanceof Error&&(s.message.includes("Invalid login credentials")?r="Invalid email or password":s.message.includes("Email not confirmed")?r="Please confirm your email address before signing in":s.message.includes("Too many requests")?r="Too many attempts. Please try again later":r=s.message),l(r),o.setError(r),d(null),u.current?.resetCaptcha()}finally{b(!1),o.setLoading(!1)}};return e.jsx("div",{className:`max-w-md mx-auto ${v}`,children:e.jsxs("div",{className:"bg-zinc-800/80 backdrop-blur-lg rounded-2xl shadow-2xl p-8 border border-zinc-700",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-neutral-400",children:"Sign in to your meme account"})]}),e.jsx(I,{redirectTo:x,showTitle:!1,className:"mb-6"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-zinc-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-zinc-800 text-neutral-400",children:"or continue with email"})})]}),m&&e.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-red-500/10 border border-red-500/20 flex items-start space-x-3",children:[e.jsx(L,{size:20,className:"text-red-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-400",children:m})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{size:20,className:"text-neutral-500"})}),e.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:j,className:"w-full pl-10 pr-4 py-3 bg-zinc-900/50 border border-zinc-600 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",placeholder:"Enter your email",disabled:a,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(S,{size:20,className:"text-neutral-500"})}),e.jsx("input",{type:c?"text":"password",id:"password",name:"password",value:t.password,onChange:j,className:"w-full pl-10 pr-12 py-3 bg-zinc-900/50 border border-zinc-600 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",placeholder:"Enter your password",disabled:a,required:!0}),e.jsx("button",{type:"button",onClick:()=>w(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:a,children:c?e.jsx(A,{size:20,className:"text-neutral-500 hover:text-neutral-400"}):e.jsx(P,{size:20,className:"text-neutral-500 hover:text-neutral-400"})})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(_,{ref:u,sitekey:N,onVerify:y,onExpire:E,theme:"dark"})}),e.jsx("button",{type:"submit",disabled:a||!g,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 disabled:from-emerald-500/50 disabled:to-green-500/50 text-white rounded-lg font-medium transition-all duration-200 transform hover:scale-[1.02] disabled:transform-none disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:20,className:"animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):e.jsx("span",{children:"Sign In"})})]}),p&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-neutral-400",children:["Don't have an account?"," ",e.jsx("button",{onClick:p,className:"text-emerald-400 hover:text-emerald-300 font-medium transition-colors",disabled:a,children:"Sign up"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{type:"button",className:"text-sm text-neutral-500 hover:text-neutral-400 transition-colors",disabled:a,onClick:()=>{alert("Forgot password functionality coming soon!")},children:"Forgot your password?"})})]})})};export{G as AuthLogin};
